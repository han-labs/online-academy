<link rel="stylesheet" href="/static/css/auth.css">

<div class="auth-wrapper">
        <div class="container">
                <div class="auth-card">
                        <div class="auth-logo">
                                <h2>Đăng ký tài khoản</h2>
                                <p>Tham gia cùng hàng triệu học viên trên Online Academy</p>
                        </div>

                        {{#if error}}
                        <div class="alert alert-danger alert-custom" role="alert">
                                <i class="bi bi-exclamation-circle"></i> {{error}}
                        </div>
                        {{/if}}

                        {{#if success}}
                        <div class="alert alert-success alert-custom" role="alert">
                                <i class="bi bi-check-circle"></i> {{success}}
                        </div>
                        {{/if}}

                        <form method="post" action="/account/register" class="auth-form" id="registerForm">
                                <div class="mb-3">
                                        <label class="form-label" for="full_name">
                                                <i class="bi bi-person"></i> Họ và tên
                                        </label>
                                        <input type="text" class="form-control" id="full_name" name="full_name"
                                                placeholder="Nguyễn Văn A" required minlength="3">
                                        <div class="invalid-feedback">Họ tên phải có ít nhất 3 ký tự</div>
                                </div>

                                <div class="mb-3">
                                        <label class="form-label" for="email">
                                                <i class="bi bi-envelope"></i> Email
                                        </label>
                                        <input type="email" class="form-control" id="email" name="email"
                                                placeholder="example@email.com" required>
                                        <div class="invalid-feedback">Email không hợp lệ</div>
                                </div>

                                <div class="mb-3">
                                        <label class="form-label" for="password">
                                                <i class="bi bi-lock"></i> Mật khẩu
                                        </label>
                                        <div class="password-toggle">
                                                <input type="password" class="form-control" id="password"
                                                        name="password" placeholder="Tối thiểu 6 ký tự" required
                                                        minlength="6">
                                                <i class="bi bi-eye toggle-icon" id="togglePassword"></i>
                                        </div>
                                        <div class="invalid-feedback">Mật khẩu phải có ít nhất 6 ký tự</div>
                                        <small class="text-muted">Mật khẩu nên bao gồm chữ hoa, chữ thường và số</small>
                                </div>

                                <div class="mb-3">
                                        <label class="form-label" for="confirm_password">
                                                <i class="bi bi-lock-fill"></i> Xác nhận mật khẩu
                                        </label>
                                        <div class="password-toggle">
                                                <input type="password" class="form-control" id="confirm_password"
                                                        name="confirm_password" placeholder="Nhập lại mật khẩu"
                                                        required>
                                                <i class="bi bi-eye toggle-icon" id="toggleConfirmPassword"></i>
                                        </div>
                                        <div class="invalid-feedback">Mật khẩu không khớp</div>
                                </div>

                                <div class="mb-3 form-check">
                                        <input type="checkbox" class="form-check-input" id="terms" required>
                                        <label class="form-check-label small" for="terms">
                                                Tôi đồng ý với <a href="#" class="text-decoration-none">Điều khoản sử
                                                        dụng</a> và
                                                <a href="#" class="text-decoration-none">Chính sách bảo mật</a>
                                        </label>
                                </div>

                                <button type="submit" class="btn btn-primary" id="btnSubmit">
                                        <i class="bi bi-person-plus"></i> Tạo tài khoản
                                </button>
                        </form>

                        <div class="auth-footer">
                                Đã có tài khoản? <a href="/account/login">Đăng nhập ngay</a>
                        </div>
                </div>
        </div>
</div>

<script>
        // Toggle password visibility
        document.getElementById('togglePassword')?.addEventListener('click', function () {
                const input = document.getElementById('password');
                const icon = this;
                if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('bi-eye');
                        icon.classList.add('bi-eye-slash');
                } else {
                        input.type = 'password';
                        icon.classList.remove('bi-eye-slash');
                        icon.classList.add('bi-eye');
                }
        });

        document.getElementById('toggleConfirmPassword')?.addEventListener('click', function () {
                const input = document.getElementById('confirm_password');
                const icon = this;
                if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('bi-eye');
                        icon.classList.add('bi-eye-slash');
                } else {
                        input.type = 'password';
                        icon.classList.remove('bi-eye-slash');
                        icon.classList.add('bi-eye');
                }
        });

        // Form validation
        document.getElementById('registerForm')?.addEventListener('submit', function (e) {
                const form = this;
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirm_password').value;
                const btn = document.getElementById('btnSubmit');

                // Check password match
                if (password !== confirmPassword) {
                        e.preventDefault();
                        document.getElementById('confirm_password').classList.add('is-invalid');
                        return false;
                }

                // Check form validity
                if (!form.checkValidity()) {
                        e.preventDefault();
                        form.classList.add('was-validated');
                        return false;
                }

                // Loading state
                btn.disabled = true;
                btn.classList.add('btn-loading');
                btn.innerHTML = '<i class="bi bi-hourglass-split"></i> Đang xử lý...';
        });

        // Remove invalid class on input
        document.querySelectorAll('.form-control').forEach(input => {
                input.addEventListener('input', function () {
                        this.classList.remove('is-invalid');
                });
        });
</script>