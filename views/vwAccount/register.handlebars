<link rel="stylesheet" href="/static/css/auth.css">

<div class="auth-wrapper">
    <div class="container">
        <div class="auth-card">
            <div class="auth-logo">
                <h2>Create an Account</h2>
                <p>Join millions of learners on Online Academy</p>
            </div>

            {{#if error}}
            <div class="alert alert-danger alert-custom" role="alert">
                <i class="bi bi-exclamation-circle"></i> {{error}}
            </div>
            {{/if}}

            {{#if success}}
            <div class="alert alert-success alert-custom" role="alert">
                <i class="bi bi-check-circle"></i> {{success}}
            </div>
            {{/if}}

            <form method="post" action="/account/register" class="auth-form" id="registerForm">
                <div class="mb-3">
                    <label class="form-label" for="full_name">
                        <i class="bi bi-person"></i> Full Name
                    </label>
                    <input type="text" class="form-control" id="full_name" name="full_name"
                        placeholder="John Doe" required minlength="3">
                    <div class="invalid-feedback">Full name must be at least 3 characters long</div>
                </div>

                <div class="mb-3">
                    <label class="form-label" for="email">
                        <i class="bi bi-envelope"></i> Email
                    </label>
                    <input type="email" class="form-control" id="email" name="email"
                        placeholder="example@email.com" required>
                    <div class="invalid-feedback">Invalid email address</div>
                </div>

                <div class="mb-3">
                    <label class="form-label" for="password">
                        <i class="bi bi-lock"></i> Password
                    </label>
                    <div class="password-toggle">
                        <input type="password" class="form-control" id="password"
                            name="password" placeholder="Minimum 6 characters" required
                            minlength="6">
                        <i class="bi bi-eye toggle-icon" id="togglePassword"></i>
                    </div>
                    <div class="invalid-feedback">Password must be at least 6 characters long</div>
                    <small class="text-muted">Password should include uppercase, lowercase letters, and numbers</small>
                </div>

                <div class="mb-3">
                    <label class="form-label" for="confirm_password">
                        <i class="bi bi-lock-fill"></i> Confirm Password
                    </label>
                    <div class="password-toggle">
                        <input type="password" class="form-control" id="confirm_password"
                            name="confirm_password" placeholder="Re-enter password"
                            required>
                        <i class="bi bi-eye toggle-icon" id="toggleConfirmPassword"></i>
                    </div>
                    <div class="invalid-feedback">Passwords do not match</div>
                </div>

                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="terms" required>
                    <label class="form-check-label small" for="terms">
                        I agree to the <a href="#" class="text-decoration-none">Terms of Use</a> and
                        <a href="#" class="text-decoration-none">Privacy Policy</a>
                    </label>
                </div>

                <button type="submit" class="btn btn-primary" id="btnSubmit">
                    <i class="bi bi-person-plus"></i> Create Account
                </button>
            </form>

            <div class="auth-footer">
                Already have an account? <a href="/account/login">Login now</a>
            </div>
        </div>
    </div>
</div>

<script>
    // Toggle password visibility
    document.getElementById('togglePassword')?.addEventListener('click', function () {
        const input = document.getElementById('password');
        const icon = this;
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('bi-eye');
            icon.classList.add('bi-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('bi-eye-slash');
            icon.classList.add('bi-eye');
        }
    });

    document.getElementById('toggleConfirmPassword')?.addEventListener('click', function () {
        const input = document.getElementById('confirm_password');
        const icon = this;
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('bi-eye');
            icon.classList.add('bi-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('bi-eye-slash');
            icon.classList.add('bi-eye');
        }
    });

    // Form validation
    document.getElementById('registerForm')?.addEventListener('submit', function (e) {
        const form = this;
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const btn = document.getElementById('btnSubmit');

        // Check password match
        if (password !== confirmPassword) {
            e.preventDefault();
            document.getElementById('confirm_password').classList.add('is-invalid');
            return false;
        }

        // Check form validity
        if (!form.checkValidity()) {
            e.preventDefault();
            form.classList.add('was-validated');
            return false;
        }

        // Loading state
        btn.disabled = true;
        btn.classList.add('btn-loading');
        btn.innerHTML = '<i class="bi bi-hourglass-split"></i> Processing...';
    });

    // Remove invalid class on input
    document.querySelectorAll('.form-control').forEach(input => {
        input.addEventListener('input', function () {
            this.classList.remove('is-invalid');
        });
    });
</script>
