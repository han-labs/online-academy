<link rel="stylesheet" href="/static/css/style.css">

<div class="mb-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{category.name}}</li>
        </ol>
    </nav>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h2 class="mb-1">
                <i class="bi bi-grid-3x3-gap text-purple me-2"></i>
                {{category.name}}
            </h2>
            <p class="text-muted mb-0">
                <i class="bi bi-book me-1"></i>
                {{formatNumber total}} courses
            </p>
        </div>

        {{!-- Sort dropdown --}}
        <div class="dropdown">
            <button class="btn btn-outline-purple dropdown-toggle" type="button" data-bs-toggle="dropdown">
                <i class="bi bi-funnel me-1"></i>
                Sort by:
                {{#if (eq sort 'newest')}}Newest
                {{else if (eq sort 'price_asc')}}Price: Low to High
                {{else if (eq sort 'best_seller')}}Best Seller
                {{else}}Top Rated{{/if}}
            </button>

            <ul class="dropdown-menu">
                <li>
                    <a class="dropdown-item {{#if (eq sort 'rating_desc')}}active{{/if}}"
                        href="?sort=rating_desc&page=1">
                        <i class="bi bi-star-fill me-1"></i> Top Rated
                    </a>
                </li>
                <li>
                    <a class="dropdown-item {{#if (eq sort 'price_asc')}}active{{/if}}" href="?sort=price_asc&page=1">
                        <i class="bi bi-currency-dollar me-1"></i> Price: Low to High
                    </a>
                </li>
                <li>
                    <a class="dropdown-item {{#if (eq sort 'newest')}}active{{/if}}" href="?sort=newest&page=1">
                        <i class="bi bi-clock me-1"></i> Newest
                    </a>
                </li>
                <li>
                    <a class="dropdown-item {{#if (eq sort 'best_seller')}}active{{/if}}"
                        href="?sort=best_seller&page=1">
                        <i class="bi bi-graph-up-arrow me-1"></i> Best Seller
                    </a>
                </li>
            </ul>
        </div>

    </div>

    {{!-- Subcategories --}}
    {{#if subcategories}}
    <div class="mb-3">
        <h6 class="text-muted mb-2">
            <i class="bi bi-tags me-1"></i>
            Subcategories:
        </h6>
        <div class="d-flex flex-wrap gap-2">
            {{#each subcategories}}
            <a href="/categories/{{id}}" class="btn btn-outline-purple btn-sm subcategory-btn">
                <i class="bi bi-folder2-open me-1"></i>
                {{name}}
            </a>
            {{/each}}
        </div>
    </div>
    {{/if}}
</div>

{{!-- Course Grid --}}
{{#if hasResults}}
<div class="row g-3 mb-4">
    {{#each courses}}
    <div class="col-6 col-md-4 col-lg-3">
        {{> _courseCard}}
    </div>
    {{/each}}
</div>

{{!-- Pagination --}}
{{#if (length (range 1 totalPages))}}
<nav aria-label="Category pagination">
    <ul class="pagination justify-content-center">
        <li class="page-item {{#if (eq page 1)}}disabled{{/if}}">
            <a class="page-link page-link-purple" href="?sort={{sort}}&page={{sub page 1}}">
                <i class="bi bi-chevron-left"></i> Previous
            </a>
        </li>

        {{#each (range 1 totalPages)}}
        <li class="page-item {{#if (eq this ../page)}}active{{/if}}">
            <a class="page-link page-link-purple" href="?sort={{../sort}}&page={{this}}">
                {{this}}
            </a>
        </li>
        {{/each}}

        <li class="page-item {{#if (eq page totalPages)}}disabled{{/if}}">
            <a class="page-link page-link-purple" href="?sort={{sort}}&page={{add page 1}}">
                Next <i class="bi bi-chevron-right"></i>
            </a>
        </li>
    </ul>
</nav>
{{/if}}

{{else}}
<div class="alert alert-purple">
    <i class="bi bi-info-circle-fill me-2"></i>
    <strong>No courses available in this category</strong>
    <p class="mb-0 mt-2">Please check back later or browse other categories.</p>
</div>
{{/if}}