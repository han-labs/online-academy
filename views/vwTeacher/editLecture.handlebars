{{> _header user=user}}

<div class="container my-5">
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold mb-1" style="color:#160438;">
                <i class="bi bi-film me-2"></i> Edit Lecture: {{lecture.title}}
            </h2>
            <p class="text-muted mb-0">Update lecture details, video & preview permissions.</p>
        </div>
    </div>

    <form action="/teacher/lecture/{{lecture.id}}/edit" method="POST" enctype="multipart/form-data"
        class="card border-0 shadow p-4 rounded-3">
        <div class="mb-3">
            <label for="title" class="form-label fw-semibold">Lecture Name</label>
            <input type="text" class="form-control" id="title" name="title" value="{{lecture.title}}" required>
        </div>

        <div class="mb-3">
            <label for="chapter_id" class="form-label fw-semibold">Select Chapter</label>
            <select class="form-select" id="chapter_id" name="chapter_id" required>
                {{#each chapters}}
                <option value="{{this.id}}" {{#if (eq this.id ../lecture.chapter_id)}}selected{{/if}}>
                    {{this.chapter_order}}. {{this.title}}
                </option>
                {{/each}}
            </select>
        </div>

        <div class="mb-3">
            <label for="duration_minutes" class="form-label fw-semibold">Duration (minutes)</label>
            <input type="number" class="form-control" id="duration_minutes" name="duration_minutes" min="1"
                value="{{lecture.duration_minutes}}">
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold d-block">Current Video</label>
            {{#if lecture.video_url}}
            <video width="100%" height="auto" controls class="d-block rounded shadow-sm mb-2">
                <source src="{{lecture.video_url}}" type="video/mp4"> Your browser does not support video.
            </video>
            {{else}}
            <p class="text-muted">No video uploaded</p>
            {{/if}}
            <label for="video" class="form-label fw-semibold">Upload New Video (optional)</label>
            <input type="file" class="form-control" id="video" name="video" accept="video/*">
        </div>

        <div class="form-check mb-4">
            <input class="form-check-input" type="checkbox" value="on" id="is_preview_allowed" name="is_preview_allowed"
                {{#if lecture.is_preview_allowed}}checked{{/if}}>
            <label class="form-check-label" for="is_preview_allowed">Allow Free Preview</label>
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-brand">
                <i class="bi bi-check-circle"></i> Update
            </button>
            <a href="/teacher/course/{{courseId}}/edit" class="btn btn-outline-secondary">Cancel</a>
        </div>
    </form>
</div>

<style>
    .btn-brand {
        background: #160438;
        color: #fff;
        border-color: #160438;
    }

    .btn-brand:hover {
        background: #2d0a5e;
        border-color: #2d0a5e;
        color: #fff;
    }
</style>